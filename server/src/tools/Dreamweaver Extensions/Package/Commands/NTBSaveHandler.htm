<!-- MENU-LOCATION=NONE -->
<!DOCTYPE HTML SYSTEM "-//Macromedia//DWExtension layout-engine 5.0//dialog">
<html>
<head>
<title>Nitobi Savehandler Wizard</title>
<script type="text/javascript" src="NTBSaveHandler.js"></script>
<script type="text/javascript" src="../Shared/Nitobi/NitobiUtility.js"></script>
<script type="text/javascript" src="../Shared/Common/Scripts/SQLStatementClass.js"></script>
<script type="text/javascript" src="../Shared/Nitobi/NitobiWizard.js"></script>
<script type="text/javascript" src="../Shared/Nitobi/NitobiSaveWizard.js"></script>
<style>
.page {
	position:absolute;
	padding:10px;
	left:0px;
	top:1px;
	visibility: hidden;
	width:600px;
	height:325px;
}
.nav
{
	visibility: hidden;
	position:absolute;
	bottom:30px;
}
select.pulldown
{
	width:200px;
}

</style>
</head>
<body onLoad="init()">
<form>

<div id="page1" class="page" style="">
<table border="0" style="width:100%;" cellpadding="5">
	<tbody>
    	<tr>
        	<td colspan="2">
                <div style="padding-left:5px;">
                    <strong>Database Connectivity (1 of 1)</strong>
                </div>
            </td>
        </tr>
        <tr>
        	<td colspan="4">
            	<div style="margin:5px 0px;padding:5px;">
                    Specify the database connection information.  The information provided here should correspond with 
                    the connection information for the component's gethandler.
                </div>
            </td>
        </tr>
    	<tr>
        	<td width="60" style="width:60px;">
            	<span></span>            </td>
  <td colspan="1">
            	<span>Server Model:</span><br/>
            	<select id="server_list" class="pulldown" name="server_list">
                	<option value="cold fusion">Cold Fusion</option>
                    <option value="php">PHP</option>
                    <option value="asp">ASP</option>
                    <option value="jsp">JSP</option>
                </select>                
            </td>
        </tr>
        <tr>
        	<td>
            	<span></span>
            </td>
            <td colspan="1">
            	<span>Connection:</span><br/>
            	<select id="connection_list" name="connection_list" class="pulldown" onChange="populateTableList()">
                </select>
                <input type="button" value="Define" onClick="showConnectionManager()" style="width:50px;"/>
            </td>
        </tr>
        <tr>
        	<td>
            	<span></span>
            </td>
            <td colspan="1">
            	<span>Table:</span><br/>
            	<select id="table_list" name="table_list" class="pulldown" onChange="populateColumnLists()">
                	<option value=""></option>
                </select>
            </td>
        </tr>
        <tr>
            <td style="width:60px;">
                <span></span>              </td>
            <td width="514">
            <span>Key:</span><br/>
                <select id="key_list" name="key_list" class="columnsList pulldown">
                </select>
            </td>
    	</tr>
    </tbody>
</table>
</div>

<div id="page2" class="page" style="width:600px;height:325px;">
	<table border="0" style="width:100%;" cellpadding="5">
    	<tbody>
        	<tr>
                <td colspan="4">
              		<div style="padding-left:5px;">
                        <strong>Result Set (2 of 2)</strong>
                    </div>
                </td>
          </tr>
            <tr>
                <td colspan="4">
                    <div style="margin:5px 0px;padding:5px;">
                        Choose which <strong>columns</strong> of data will be returned to the component.  The columns 
                        specified here should correspond with the columns specified in the declaration 
                        of the component.<br/><br/>
                        The column selected as the <strong>key</strong> column is used by the component to uniquely identify
                        a row.
                    </div>
                </td>
            </tr>
            <tr>
            	<td>
                	<span></span>
                </td>
                <td colspan="3">
                	<span>Get Handler</span><br/>
                	<input id="gethandler" type="text" style="width:200px;" onBlur="updateColumnLists()"/>
                    <br/>
                    <span>If you specify the get handler file that corresponds to this savehandler, the key and column information
                    		will be populated automatically
                    </span>
                </td>
            </tr>
            <tr>
           	  <td style="width:60px;">
                    <span></span>              </td>
                <td width="200">
               		<span>Key:</span><br/>
                    <select id="key_list" class="columnsList pulldown">
                    </select>
              </td>
       	  </tr>
            <tr>
            	<td>
                    <span></span>
                </td>
                <td>
                    <span>Included Columns</span>
                    <select id="include_columns_list" disabled="false" size="6" 
                        style="width:200px;height:100px;margin-right:0px;" class="columnsList">
                    </select>
                </td>
                <td>
      				<input type="button" value="<<" onClick="addColumn()"/>
                    <input type="button" value=">>" onClick="removeColumn()"/>
              </td>
              <td>
                    <span>Excluded Columns</span>
					<select id="exclude_columns_list" disabled="false" size="6" 
                        style="width:200px;height:100px;" class="">
           			</select>
              </td>
          </tr>
        </tbody>
    </table>
</div>

<div id="buttons" class="nav">
	<table border="0" style="width:200px;">
    	<tbody>
        	<tr>
                <td>
                    <input type="button" value="Cancel" onClick="window.close()" id="cancel_button"/>
                    <input type="button" disabled="true" value="Previous" onClick="doPrevious()" id="previous_button"/>
                    <input type="button" value="Finish" onClick="doNext()" id="next_button"/>
            	</td>
            </tr>
        </tbody>
    </table>
</div>
</form>
</body>
</html>